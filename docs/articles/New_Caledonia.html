<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSDM on New Caledonia • jsdmnc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="JSDM on New Caledonia">
<meta property="og:description" content="jsdmnc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jsdmnc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/New_Caledonia.html">JSDM on New Caledonia</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>JSDM on New Caledonia</h1>
            
      
      
      <div class="hidden name"><code>New_Caledonia.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">jsdmnc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h2>
<p>Load shapefile of Grande Terre borders. Our study is only on Grande
Terre because there isn’t inventory on others island of New
Caledonia.</p>
<p>We also need environmental and climatic variables for compute JSDM
model. You can use <code>gecevar</code> to extract easily all data.</p>
<p>Those file are crop to keep only data of Grande Terre.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">EPSG</span> <span class="op">&lt;-</span> <span class="fl">3163</span></span>
<span></span>
<span><span class="va">GT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data_raw"</span>, <span class="st">"Grande_Terre"</span>, <span class="st">"Grande_Terre.shp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">GT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reproject_sf_stars.html">reproject_sf_stars</a></span><span class="op">(</span>EPSG <span class="op">=</span> <span class="va">EPSG</span>, sf_stars_object <span class="op">=</span> <span class="va">GT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">write_sf</a></span><span class="op">(</span><span class="va">GT</span>, <span class="fu">here</span><span class="op">(</span><span class="st">"data_raw"</span>, <span class="st">"Grande_Terre"</span>, <span class="st">"Grande_Terre.shp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/write_stars.html" class="external-link">write_stars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_normalize.html" class="external-link">st_normalize</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html" class="external-link">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"environ_allNC.tif"</span><span class="op">)</span><span class="op">)</span>, <span class="va">GT</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_normalize.html" class="external-link">st_normalize</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html" class="external-link">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"current_chelsaNC.tif"</span><span class="op">)</span><span class="op">)</span>, <span class="va">GT</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              along <span class="op">=</span> <span class="st">"band"</span><span class="op">)</span>,</span>
<span>            <span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"dataNC.tif"</span><span class="op">)</span>,</span>
<span>            options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"COMPRESS=LZW"</span>,<span class="st">"PREDICTOR=2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-moist-forest-mask">Create moist forest mask<a class="anchor" aria-label="anchor" href="#create-moist-forest-mask"></a>
</h2>
<p>We need to keep only moist forest that isn’t mangrove. To do this we
remove all forest with an altitude &lt; 10m. For moist forest, we use
FAO definition ( MAP &gt;=1500 mm, &lt;5 months where precipitations
&lt; 100 mm).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elevation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"dataNC.tif"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="st">"elevation"</span><span class="op">]</span></span>
<span><span class="va">forest_per</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"dataNC.tif"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="st">"forest"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_sf_forest.html">create_sf_forest</a></span><span class="op">(</span>EPSG <span class="op">=</span> <span class="va">EPSG</span>, altitude_min <span class="op">=</span> <span class="fl">10</span>, percentage_min <span class="op">=</span> <span class="fl">50</span>, elevation <span class="op">=</span> <span class="va">elevation</span>, forest <span class="op">=</span> <span class="va">forest_per</span><span class="op">)</span></span>
<span><span class="va">monthly_precipitation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"current_chelsaNC.tif"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pr"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">moist_forest_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_sf_moist_forest.html">create_sf_moist_forest</a></span><span class="op">(</span>EPSG <span class="op">=</span> <span class="va">EPSG</span>, forest <span class="op">=</span> <span class="va">forest</span>, monthly_precipitation <span class="op">=</span> <span class="va">monthly_precipitation</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">write_sf</a></span><span class="op">(</span><span class="va">moist_forest_sf</span>, <span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"moist_forest.shp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-explanorities-variables-for-jsdm-algorithme">Create explanorities variables for JSDM algorithme<a class="anchor" aria-label="anchor" href="#create-explanorities-variables-for-jsdm-algorithme"></a>
</h2>
<p>Create a Tiff file with only needed variables. You can select
variables you want and power of each variables.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_NC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"dataNC.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">var_jSDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_var_JSDM.html">extract_var_JSDM</a></span><span class="op">(</span>stars_object <span class="op">=</span> <span class="va">data_NC</span>, variables_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peridotites"</span>, <span class="st">"bio1"</span>, <span class="st">"bio4"</span>, <span class="st">"bio12"</span>, <span class="st">"bio15"</span>, <span class="st">"cwd"</span><span class="op">)</span>,</span>
<span>                 power_variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/write_stars.html" class="external-link">write_stars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">var_jSDM</span><span class="op">)</span>, <span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"var_jSDM.tif"</span><span class="op">)</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"COMPRESS=LZW"</span>,<span class="st">"PREDICTOR=2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coord_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv2</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data_raw"</span>, <span class="st">"NCpippn"</span>, <span class="st">"coord_site.csv"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="va">coord_site</span><span class="op">[</span>, <span class="st">"AREA"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">NC_PIPPN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv2</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data_raw"</span>, <span class="st">"NCpippn"</span>, <span class="st">"data_clear.csv"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">site</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">coord_site</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">coord_site</span><span class="op">$</span><span class="va">AREA</span><span class="op">[</span><span class="va">site</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">NC_PIPPN</span><span class="op">$</span><span class="va">AREA</span><span class="op">[</span><span class="va">coord_site</span><span class="op">$</span><span class="va">plot_name</span><span class="op">[</span><span class="va">site</span><span class="op">]</span> <span class="op">==</span> <span class="va">NC_PIPPN</span><span class="op">$</span><span class="va">plot_name</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">var_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_JSDM.html">data_JSDM</a></span><span class="op">(</span>EPSG <span class="op">=</span> <span class="va">EPSG</span>, latlon_site <span class="op">=</span> <span class="va">coord_site</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, area_site <span class="op">=</span> <span class="va">coord_site</span><span class="op">$</span><span class="va">AREA</span>, </span>
<span>                      path_tiff <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"var_jSDM.tif"</span><span class="op">)</span>, log_area_site <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="jsdm-binomial-probit">jSDM binomial probit<a class="anchor" aria-label="anchor" href="#jsdm-binomial-probit"></a>
</h2>
<p>Compute jSDM binomial probit method with <code>jSDM</code> package.
Only mean options of <code>jSDM_binomial_probit</code> are available.
Display some plot to check if <code>jSDM_binomial_probit</code> model
run well. All plots, are about inventories sites.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv2</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data_raw"</span>, <span class="st">"NCpippn"</span>, <span class="st">"Presence_Absence.csv"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="va">PA</span><span class="op">$</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">jSDM_bin_pro</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JSDM_bino_pro.html">JSDM_bino_pro</a></span><span class="op">(</span>presence_data <span class="op">=</span> <span class="va">PA</span>, site_data <span class="op">=</span> <span class="va">var_site</span>, n_latent <span class="op">=</span> <span class="fl">2</span>, V_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fl">0.001</span><span class="op">)</span>,</span>
<span>              mu_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fl">0.25</span><span class="op">)</span>, nb_species_plot <span class="op">=</span> <span class="fl">2</span>, display <span class="op">=</span> <span class="cn">TRUE</span>, save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">jSDM_bin_pro</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"jSDM_bin_pro.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_pres_est_one_species.html">plot_pres_est_one_species</a></span><span class="op">(</span>jSDM_binom_pro <span class="op">=</span> <span class="va">jSDM_bin_pro</span>, coord_site <span class="op">=</span> <span class="va">coord_site</span>, country_name <span class="op">=</span> <span class="st">"New Caledonia"</span>,</span>
<span>                          display_plot <span class="op">=</span> <span class="cn">TRUE</span>, save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_species_richness.html">plot_species_richness</a></span><span class="op">(</span>jSDM_binom_pro <span class="op">=</span> <span class="va">jSDM_bin_pro</span>, coord_site <span class="op">=</span> <span class="va">coord_site</span>, country_name <span class="op">=</span> <span class="st">"New Caledonia"</span>,</span>
<span>                      display_plot <span class="op">=</span> <span class="cn">TRUE</span>, save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="knn-interpolation">kNN interpolation<a class="anchor" aria-label="anchor" href="#knn-interpolation"></a>
</h2>
<p>Compute a k-Nearest Neighbors interpolation on site-effect alpha and
latent variables. So we can get probabilities of presence for each
species on each pixel of forest.</p>
<p>This function takes around 25min to run.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/knn_interpolation_jSDM.html">knn_interpolation_jSDM</a></span><span class="op">(</span>jSDM_binom_pro <span class="op">=</span> <span class="va">jSDM_bin_pro</span>, k <span class="op">=</span> <span class="fl">5</span>, coord_site <span class="op">=</span> <span class="va">coord_site</span>, sf_forest <span class="op">=</span> <span class="va">moist_forest_sf</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="probabilities-on-forest-area-and-plots">Probabilities on forest area and plots<a class="anchor" aria-label="anchor" href="#probabilities-on-forest-area-and-plots"></a>
</h2>
<p>Compute from kNN interpolation a map with probability of presence for
each species on each pixel of forest in Grande Terre.</p>
<p>In this case we remove alpha for compute probabilities of presence to
avoid high species richness values. This process doesn’t change the
order of probabilities in pixel.</p>
<p>Plot of species richness on New Caledonia forest.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"alpha_knn.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">W1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"lv_1_knn.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">W2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"lv_2_knn.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">W1</span>, <span class="va">W2</span>, along <span class="op">=</span> <span class="st">"band"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/prob_est_species_forest.html">prob_est_species_forest</a></span><span class="op">(</span>alpha_stars <span class="op">=</span> <span class="va">alpha</span>, latent_var_stars <span class="op">=</span> <span class="va">W</span>, jSDM_binom_pro <span class="op">=</span> <span class="va">jSDM_bin_pro</span>,</span>
<span>                        data_stars <span class="op">=</span> <span class="va">var_jSDM</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_prob_pres_interp.html">plot_prob_pres_interp</a></span><span class="op">(</span>theta_stars <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"theta"</span>, <span class="st">"KNN_theta_01.tif"</span><span class="op">)</span><span class="op">)</span>, country_sf <span class="op">=</span> <span class="va">GT</span>, </span>
<span>                      display_plot <span class="op">=</span> <span class="cn">TRUE</span>, save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">species_richness_terra</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_species_richness_interpolated.html">plot_species_richness_interpolated</a></span><span class="op">(</span>list_theta_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"theta"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                                             country_sf <span class="op">=</span> <span class="va">GT</span>, display_plot <span class="op">=</span> <span class="cn">TRUE</span>, save_plot <span class="op">=</span> <span class="cn">TRUE</span>, save_tif <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dimension-reduction">Dimension reduction<a class="anchor" aria-label="anchor" href="#dimension-reduction"></a>
</h2>
<p>Decrease dimensions using PCA or tSNE method then determine number of
communities with dendrogram compute with HCA.</p>
<p>Big drop-off in dendrogram are “good” numbers of groups. If
dendrogram doesn’t have drop-off with one reduction dimension method,
use the other method.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coord_PCA_or_tSNE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PCA_or_tSNE_on_pro_pres_est.html">PCA_or_tSNE_on_pro_pres_est</a></span><span class="op">(</span>tSNE <span class="op">=</span> <span class="cn">TRUE</span>, PCA <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                                 list_theta_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"theta"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                                 display_plot <span class="op">=</span> <span class="cn">TRUE</span>, save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="clustering">Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h2>
<p>Pixel’s clustering is computing with a method among HCA, kmeans or
Expectation-Maximisation (EM).</p>
<p>Create outputs to visualize clustering in the first three dimensions
of PCA or tSNE.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KM_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_HCA_EM_Kmeans.html">plot_HCA_EM_Kmeans</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"KM"</span>, pixel_df <span class="op">=</span> <span class="va">coord_PCA_or_tSNE</span>, nb_group <span class="op">=</span> <span class="fl">7</span>, display_plot_3d <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   display_plot_2d <span class="op">=</span> <span class="cn">TRUE</span>, save_plot_2d <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-with-colors-and-groups">Plot with colors and groups<a class="anchor" aria-label="anchor" href="#plot-with-colors-and-groups"></a>
</h2>
<p>Plot New Caledonia map with values in of the first three axis of PCA
or tSNE method for each pixel. To see impacts of each axis on pixels.
Those plots have different colors (Red, Green, Blue) for each axis of
PCA or tSNE. To see diversity <span class="math inline">\(\beta\)</span>, display three plots in one. This
plot in a RGB plot, similar colors are pixels with similar trees
communities. Plot groups on New Caledonia map with mean color of each
group.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pixels_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"theta"</span>, <span class="st">"KNN_theta_01.tif"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,,<span class="op">]</span></span>
<span><span class="va">pixels_group</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pixels_group</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">KM_groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pixels_group</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"groups"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_RGB_group_by_color.html">plot_RGB_group_by_color</a></span><span class="op">(</span>stars_pixels_group <span class="op">=</span> <span class="va">pixels_group</span>, coord_pixel <span class="op">=</span> <span class="va">coord_PCA_or_tSNE</span>, country_sf <span class="op">=</span> <span class="va">GT</span>,</span>
<span>                        display_plot <span class="op">=</span> <span class="cn">TRUE</span>, save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">max_min_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/max_min_species_group.html">max_min_species_group</a></span><span class="op">(</span>list_theta_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"output"</span>, <span class="st">"theta"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                                    stars_pixels_group <span class="op">=</span> <span class="va">pixels_group</span>, nb_top_species <span class="op">=</span> <span class="fl">20</span>, save_csv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sensibility-specificity">Sensibility &amp; Specificity<a class="anchor" aria-label="anchor" href="#sensibility-specificity"></a>
</h2>
<p>Sensibility and specificity are calculated on inventories sites
without cross validation. True Skills Statistic (TSS) is great above
0.7</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span>PA <span class="op">=</span> <span class="va">PA</span>, jSDM_binom_pro <span class="op">=</span> <span class="va">jSDM_bin_pro</span><span class="op">)</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specificity.html">specificity</a></span><span class="op">(</span>PA <span class="op">=</span> <span class="va">PA</span>, jSDM_binom_pro <span class="op">=</span> <span class="va">jSDM_bin_pro</span><span class="op">)</span></span>
<span><span class="va">TSS</span> <span class="op">&lt;-</span> <span class="va">sens</span> <span class="op">+</span> <span class="va">spe</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">TSS</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
